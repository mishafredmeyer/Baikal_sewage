c18_2w6, c18_2w6t, c20_4w6) %>%
gather(key = fatty_acid, value = concentration, c18_3w3:c20_4w6) %>%
group_by(site, Genus, Species) %>%
mutate(total_fatty_acid = sum(concentration),
prop_fatty_acid = concentration / total_fatty_acid) %>%
select(-concentration, - total_fatty_acid) %>%
spread(key = fatty_acid, value = prop_fatty_acid) %>%
unite(col = taxon, c("Genus", "Species"), sep = "_", remove = FALSE)
# Identify mean, variance, and coefficient of variation across all
# sites for each taxonomic grouping
mean <- as.vector(sapply(fatty_acid_essential_wide[, 5:12], mean))
var <- as.vector(sapply(fatty_acid_essential_wide[, 5:12], var))
mean_var <- data.frame(cbind(Mean = mean[1:8], Variance = var[1:8]))
mean_var <- dplyr::mutate(mean_var, Var_Mean_Ratio = Variance / Mean)
row.names(mean_var) <- colnames(fatty_acid_essential_wide[, 5:12])
mean_var[order(mean_var$Var_Mean_Ratio, decreasing = TRUE), ]
# Perform NMDS
essential_fatty_acid_metaMDS <- metaMDS(comm = fatty_acid_essential_wide[, 5:12],
distance = "bray", k = 2, try = 100)
essential_fatty_acid_metaMDS
# Aggregate data scores for plotting and analysis of the NMDS
data_scores <- as.data.frame(scores(essential_fatty_acid_metaMDS)) %>%
mutate(site = fatty_acid_essential_wide$site,
taxon = fatty_acid_essential_wide$taxon,
taxon = gsub(pattern = "_", replacement = " ", x = taxon),
taxon = gsub(pattern = "NA", replacement = "", x = taxon),
taxon = gsub(pattern = "Drapa", replacement = "Drapa spp.", x = taxon))
# Plot NMDS for all species but only Essential Fatty Acids
# This plot is figure S2 in the associated ms.
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, shape = taxon),
size = 10, shape = 21, color = "grey60", alpha = .75, stroke = 2) +
#scale_fill_manual(values = inferno(69)[c(1, 13, 18, 20, 27, 33, 38, 45, 55)]) +
scale_shape_manual(values = c(1:7)) +
ggtitle("NMDS with Essential FA Spectrum") +
annotate("label", x = -0.5, y = 0.35,
label = paste("Stress: ",
round(essential_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Plot NMDS for all species but only Essential Fatty Acids
# This plot is figure S2 in the associated ms.
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, shape = taxon),
size = 10, alpha = .75) +
#scale_fill_manual(values = inferno(69)[c(1, 13, 18, 20, 27, 33, 38, 45, 55)]) +
scale_shape_manual(values = c(1:7)) +
ggtitle("NMDS with Essential FA Spectrum") +
annotate("label", x = -0.5, y = 0.35,
label = paste("Stress: ",
round(essential_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
ggsave(filename = "all_species_essential_FA_symbole.png", plot = nmds, device = "png",
path = "../figures/", width = 12, height = 10, units = "in",
dpi = 300)
ggsave(filename = "all_species_essential_FA_symbol.png", plot = nmds, device = "png",
path = "../figures/", width = 12, height = 10, units = "in",
dpi = 300)
tinytex::tlmgr_update()
install.packages("tinytex")
library(tinytex)
tinytex:::install_prebuilt()
library(tinytex)
# Create a dataframe of the entire fatty acid spectrum
fatty_acid_whole_wide <- fatty_acid %>%
filter(Genus != "Hyalella") %>%
select(site:c24_0) %>%
gather(key = fatty_acid, value = concentration, c12_0:c24_0) %>%
group_by(site, Genus, Species) %>%
mutate(total_fatty_acid = sum(concentration),
prop_fatty_acid = concentration / total_fatty_acid) %>%
select(-concentration, - total_fatty_acid) %>%
spread(key = fatty_acid, value = prop_fatty_acid) %>%
unite(taxon, c("Genus", "Species"), sep = "_", remove = FALSE)
# Identify mean, variance, and coefficient of variation across all
# sites for each taxonomic grouping
mean <- as.vector(sapply(fatty_acid_whole_wide[, 5:63], mean))
var <- as.vector(sapply(fatty_acid_whole_wide[, 5:63], var))
mean_var <- data.frame(cbind(Mean = mean[1:59], Variance = var[1:59]))
mean_var <- dplyr::mutate(mean_var, Var_Mean_Ratio = Variance / Mean)
row.names(mean_var) <- colnames(fatty_acid_whole_wide[, 5:63])
mean_var[order(mean_var$Var_Mean_Ratio, decreasing = TRUE), ]
write.csv(x = mean_var[order(mean_var$Var_Mean_Ratio, decreasing = TRUE), ], file = "../tables/cv_all_fa.csv", row.names = FALSE)
# Perform NMDS
whole_fatty_acid_metaMDS <- metaMDS(comm = fatty_acid_whole_wide[, 5:63],
distance = "bray", k = 2, try = 100)
whole_fatty_acid_metaMDS
# Extract scores for each site and add additional data for analysis and plotting
data_scores <- as.data.frame(scores(whole_fatty_acid_metaMDS)) %>%
mutate(site = fatty_acid_whole_wide$site,
taxon = fatty_acid_whole_wide$taxon,
taxon = gsub(pattern = "_", replacement = " ", x = taxon),
taxon = gsub(pattern = "NA", replacement = "", x = taxon),
taxon = gsub(pattern = "Drapa", replacement = "Drapa spp.", x = taxon))
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, shape = taxon),
size = 10, alpha = .75) +
#scale_color_manual(values = viridis(69)[c(1, 13, 25, 33, 38, 50, 60, 69)]) +
scale_shape_manual(values = c(1:7)) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
library(kableExtra)
install.packages("kableExtra")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(tinytex)
library(kableExtra)
# Chunk 2
library(tidyverse)
library(viridis)
library(viridisLite)
library(vegan)
# 1. Load the data --------------------------------------------------------
fatty_acid <- read.csv(file = "../cleaned_data/fatty_acid.csv",
header = TRUE, stringsAsFactors = FALSE)
metadata <- read.csv(file = "../cleaned_data/metadata.csv",
header = TRUE, stringsAsFactors = FALSE)
distance <- read.csv(file = "../cleaned_data/distance_weighted_population_metrics.csv",
header = TRUE, stringsAsFactors = FALSE)
nutrients <- read.csv(file = "../cleaned_data/nutrients.csv",
header = TRUE, stringsAsFactors = FALSE)
metadata_dist <- full_join(x = metadata, y = distance)
ppcp <- read.csv(file = "../cleaned_data/ppcp.csv",
header = TRUE, stringsAsFactors = FALSE)
ppcp_meta_dist <- full_join(x = ppcp, y = metadata_dist, by = c("site"))
fatty_acid_ppcp_meta_dist <- inner_join(x = fatty_acid, y = ppcp_meta_dist,
by = c("site")) %>%
unite(taxon, c("Genus", "Species"), remove = FALSE)
# Create a dataframe of the entire fatty acid spectrum
fatty_acid_whole_wide <- fatty_acid %>%
filter(Genus != "Hyalella") %>%
select(site:c24_0) %>%
gather(key = fatty_acid, value = concentration, c12_0:c24_0) %>%
group_by(site, Genus, Species) %>%
mutate(total_fatty_acid = sum(concentration),
prop_fatty_acid = concentration / total_fatty_acid) %>%
select(-concentration, - total_fatty_acid) %>%
spread(key = fatty_acid, value = prop_fatty_acid) %>%
unite(taxon, c("Genus", "Species"), sep = "_", remove = FALSE)
# Identify mean, variance, and coefficient of variation across all
# sites for each taxonomic grouping
mean <- as.vector(sapply(fatty_acid_whole_wide[, 5:63], mean))
var <- as.vector(sapply(fatty_acid_whole_wide[, 5:63], var))
mean_var <- data.frame(cbind(Mean = mean[1:59], Variance = var[1:59]))
mean_var <- dplyr::mutate(mean_var, Var_Mean_Ratio = Variance / Mean)
row.names(mean_var) <- colnames(fatty_acid_whole_wide[, 5:63])
#mean_var[order(mean_var$Var_Mean_Ratio, decreasing = TRUE), ]
# Create a dataframe of only the essential fatty acids
fatty_acid_essential_wide <- fatty_acid %>%
filter(Genus != "Hyalella") %>%
select(site, Genus, Species, c18_3w3, c18_4w3, c20_5w3, c22_5w3, c22_6w3,
c18_2w6, c18_2w6t, c20_4w6) %>%
gather(key = fatty_acid, value = concentration, c18_3w3:c20_4w6) %>%
group_by(site, Genus, Species) %>%
mutate(total_fatty_acid = sum(concentration),
prop_fatty_acid = concentration / total_fatty_acid) %>%
select(-concentration, - total_fatty_acid) %>%
spread(key = fatty_acid, value = prop_fatty_acid) %>%
unite(col = taxon, c("Genus", "Species"), sep = "_", remove = FALSE)
# Identify mean, variance, and coefficient of variation across all
# sites for each taxonomic grouping
mean <- as.vector(sapply(fatty_acid_essential_wide[, 5:12], mean))
var <- as.vector(sapply(fatty_acid_essential_wide[, 5:12], var))
mean_var <- data.frame(cbind(Mean = mean[1:8], Variance = var[1:8]))
mean_var <- dplyr::mutate(mean_var, Var_Mean_Ratio = Variance / Mean)
row.names(mean_var) <- colnames(fatty_acid_essential_wide[, 5:12])
#mean_var[order(mean_var$Var_Mean_Ratio, decreasing = TRUE), ]
# Chunk 3
fatty_acid_prop_ppcp_meta_dist <- fatty_acid_ppcp_meta_dist %>%
gather(key = fatty_acid, value = concentration, c12_0:c24_0) %>%
group_by(site, Genus, Species) %>%
mutate(total_fatty_acid = sum(concentration),
prop_fatty_acid = concentration / total_fatty_acid) %>%
select(-concentration, -total_fatty_acid) %>%
spread(key = fatty_acid, value = prop_fatty_acid)
sample_count <- fatty_acid_ppcp_meta_dist %>%
group_by(Genus, Species) %>%
count()
mean_odd_carbon_chains <- fatty_acid_prop_ppcp_meta_dist %>%
mutate(total_odd_carbon_chains = a_15_0 + i_15_0 + c15_0 + c15_1w7 + a_17_0 + i_17_0 + c17_0 + c17_1n7) %>%
select(site, Genus, Species, total_odd_carbon_chains) %>%
group_by(Genus, Species) %>%
summarize(mean_odd_chains = mean(total_odd_carbon_chains),
sd_odd_chains = sd(total_odd_carbon_chains)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella")
# Chunk 4
# Perform NMDS
whole_fatty_acid_metaMDS <- metaMDS(comm = fatty_acid_whole_wide[, 5:63],
distance = "bray", k = 2, try = 100)
#whole_fatty_acid_metaMDS
# Extract scores for each site and add additional data for analysis and plotting
data_scores <- as.data.frame(scores(whole_fatty_acid_metaMDS)) %>%
mutate(site = fatty_acid_whole_wide$site,
taxon = fatty_acid_whole_wide$taxon,
taxon = gsub(pattern = "_", replacement = " ", x = taxon),
taxon = gsub(pattern = "NA", replacement = "", x = taxon),
taxon = gsub(pattern = "Drapa", replacement = "Drapa spp.", x = taxon))
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, shape = taxon),
size = 10, alpha = .75) +
#scale_color_manual(values = viridis(69)[c(1, 13, 25, 33, 38, 50, 60, 69)]) +
scale_shape_manual(values = c(1:7)) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Perform NMDS
essential_fatty_acid_metaMDS <- metaMDS(comm = fatty_acid_essential_wide[, 5:12],
distance = "bray", k = 2, try = 100)
essential_fatty_acid_metaMDS
# Aggregate data scores for plotting and analysis of the NMDS
data_scores <- as.data.frame(scores(essential_fatty_acid_metaMDS)) %>%
mutate(site = fatty_acid_essential_wide$site,
taxon = fatty_acid_essential_wide$taxon,
taxon = gsub(pattern = "_", replacement = " ", x = taxon),
taxon = gsub(pattern = "NA", replacement = "", x = taxon),
taxon = gsub(pattern = "Drapa", replacement = "Drapa spp.", x = taxon))
# Plot NMDS for all species but only Essential Fatty Acids
# This plot is figure S2 in the associated ms.
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, shape = taxon),
size = 10, alpha = .75) +
#scale_fill_manual(values = inferno(69)[c(1, 13, 18, 20, 27, 33, 38, 45, 55)]) +
scale_shape_manual(values = c(1:7)) +
ggtitle("NMDS with Essential FA Spectrum") +
annotate("label", x = -0.5, y = 0.35,
label = paste("Stress: ",
round(essential_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
plot(nmds)
fatty_acid_prop_ppcp_meta_dist
fatty_acid_type_props_summary_table <- fatty_acid_prop_ppcp_meta_dist %>%
filter(Genus == "Periphyton") %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
mutate(fatty_acid_type = ifelse(fatty_acid %in% safa, "SAFA", "Branched"),
fatty_acid_type = ifelse(fatty_acid %in% mufa, "MUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% scufa, "SCUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% lcufa, "LCUFA", fatty_acid_type)) %>%
select(site, Genus, Species, fatty_acid_type, fa_prop) %>%
group_by(site, Genus, Species, fatty_acid_type) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
group_by(Genus, Species, fatty_acid_type) %>%
summarize(mean_fa_prop = mean(sum_fa_prop)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella") %>%
spread(fatty_acid_type, mean_fa_prop)
safa <- c("c14_0", "c12_0", "a_15_0", "a_17_0", "c15_0",
"c16_0", "c17_0", "c18_0", "c20_0", "c22_0", "c24_0")
mufa <- c("c14_1n5", "c15_1w7", "c17_1n7",
"c16_1w5", "c16_1w6", "c16_1w7", "c16_1w8", "c16_1w9",
"c18_1w7", "c18_1w9", "c20_1w7", "c20_1w9", "c22_1w7", "c22_1w9")
scufa <- c("c16_2w4", "c16_2w6", "c16_2w7", "c16_3w3", "c16_3w4", "c16_3w6", "c16_4w1", "c16_4w3",
"c18_2w6", "c18_2w6t", "c18_3w3", "c18_3w6", "c18_4w3", "c18_4w4", "c18_5w3")
lcufa <- c("c20_2_5_11", "c20_2_5_13", "c20_2w6", "c20_3w3", "c20_3w6", "c20_4w3", "c20_4w6", "c20_5w3",
"c22_2w6", "c22_3w3", "c22_4w3", "c22_4w6", "c22_5w3", "c22_5w6", "c22_6w3")
fatty_acid_type_props_summary_table <- fatty_acid_prop_ppcp_meta_dist %>%
filter(Genus == "Periphyton") %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
mutate(fatty_acid_type = ifelse(fatty_acid %in% safa, "SAFA", "Branched"),
fatty_acid_type = ifelse(fatty_acid %in% mufa, "MUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% scufa, "SCUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% lcufa, "LCUFA", fatty_acid_type)) %>%
select(site, Genus, Species, fatty_acid_type, fa_prop) %>%
group_by(site, Genus, Species, fatty_acid_type) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
group_by(Genus, Species, fatty_acid_type) %>%
summarize(mean_fa_prop = mean(sum_fa_prop)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella") %>%
spread(fatty_acid_type, mean_fa_prop)
fatty_acid_type_props_summary_table
fatty_acid_type_props_summary_table <- fatty_acid_prop_ppcp_meta_dist %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
mutate(fatty_acid_type = ifelse(fatty_acid %in% safa, "SAFA", "Branched"),
fatty_acid_type = ifelse(fatty_acid %in% mufa, "MUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% scufa, "SCUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% lcufa, "LCUFA", fatty_acid_type)) %>%
select(site, Genus, Species, fatty_acid_type, fa_prop) %>%
group_by(site, Genus, Species, fatty_acid_type) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
group_by(Genus, Species, fatty_acid_type) %>%
summarize(mean_fa_prop = mean(sum_fa_prop)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella") %>%
spread(fatty_acid_type, mean_fa_prop)
fatty_acid_type_props_summary_table
fatty_acid_type_props_summary_table <- fatty_acid_prop_ppcp_meta_dist %>%
filter(Genus == "Periphyton") %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
mutate(fatty_acid_type = ifelse(fatty_acid %in% safa, "SAFA", "Branched"),
fatty_acid_type = ifelse(fatty_acid %in% mufa, "MUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% scufa, "SCUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% lcufa, "LCUFA", fatty_acid_type)) %>%
select(site, Genus, Species, fatty_acid_type, fa_prop) %>%
group_by(site, Genus, Species, fatty_acid_type) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
group_by(Genus, Species, fatty_acid_type) %>%
summarize(cv_fa_prop = mean(sum_fa_prop)/var(sum_fa_prop)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella") %>%
spread(fatty_acid_type, cv_fa_prop)
fatty_acid_type_props_summary_table
fatty_acid_type_props_summary_table <- fatty_acid_prop_ppcp_meta_dist %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
mutate(fatty_acid_type = ifelse(fatty_acid %in% safa, "SAFA", "Branched"),
fatty_acid_type = ifelse(fatty_acid %in% mufa, "MUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% scufa, "SCUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% lcufa, "LCUFA", fatty_acid_type)) %>%
select(site, Genus, Species, fatty_acid_type, fa_prop) %>%
group_by(site, Genus, Species, fatty_acid_type) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
group_by(Genus, Species, fatty_acid_type) %>%
summarize(cv_fa_prop = mean(sum_fa_prop)/var(sum_fa_prop)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella") %>%
spread(fatty_acid_type, cv_fa_prop)
fatty_acid_type_props_summary_table
fatty_acid_type_props_summary_table <- fatty_acid_prop_ppcp_meta_dist %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
mutate(fatty_acid_type = ifelse(fatty_acid %in% safa, "SAFA", "Branched"),
fatty_acid_type = ifelse(fatty_acid %in% mufa, "MUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% scufa, "SCUFA", fatty_acid_type),
fatty_acid_type = ifelse(fatty_acid %in% lcufa, "LCUFA", fatty_acid_type)) %>%
select(site, Genus, Species, fatty_acid_type, fa_prop) %>%
group_by(site, Genus, Species, fatty_acid_type) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
group_by(Genus, Species, fatty_acid_type) %>%
summarize(cv_fa_prop = var(sum_fa_prop)/mean(sum_fa_prop)) %>%
inner_join(., sample_count) %>%
filter(Genus != "Hyalella") %>%
spread(fatty_acid_type, cv_fa_prop)
fatty_acid_type_props_summary_table
peri_ppcp_lm <- lm((log10((c16_4w3 + c16_3w3 + c16_2w6) / (  c20_4w3 + c20_2w6 + c20_3w6 + c22_4w6 ))) ~ log10(ppcp_sum),
data = filter(fatty_acid_prop_ppcp_meta_dist, Genus == "Periphyton"))
#summary(peri_ppcp_lm)
# Second compare essential fatty acid ratios in invertebrates with total PPCP conentration
eulimnogammarus_verrucosus_ppcp_lm <- lm(((c18_3w3) / ( c20_5w3)) ~ log10(ppcp_sum),
data = filter(fatty_acid_prop_ppcp_meta_dist,
taxon == "Eulimnogammarus_verrucosus"))
#summary(eulimnogammarus_verrucosus_ppcp_lm)
eulimnogammarus_vitatus_ppcp_lm <- lm(((c18_3w3) / ( c20_5w3)) ~ log10(ppcp_sum),
data = filter(fatty_acid_prop_ppcp_meta_dist,
taxon == "Eulimnogammarus_vittatus"))
#summary(eulimnogammarus_vitatus_ppcp_lm)
r_squared <- c(summary(peri_ppcp_lm)$r.squared,
summary(eulimnogammarus_verrucosus_ppcp_lm)$r.squared,
summary(eulimnogammarus_vitatus_ppcp_lm)$r.squared)
p_values <- c(summary(peri_ppcp_lm)$coefficients[2,4],
summary(eulimnogammarus_verrucosus_ppcp_lm)$coefficients[2,4],
summary(eulimnogammarus_vitatus_ppcp_lm)$coefficients[2,4])
taxon <- c("Periphyton", "Eulimnogammarus verrucosus", "Eulimnogammarus vittatus")
labels <- data.frame(taxon, p_values, r_squared) %>%
mutate(label = paste0("p-value: ",
round(p_values, 3),
"\nR-squared: ",
round(r_squared, 3)))
# This figure is Figure 7 within the body of the associated manuscript.
# (c16_4w3 + c16_3w3 + c16_2w6) / (  c20_4w3 + c20_2w6 + c20_3w6 + c22_4w6 )
ppcp_fa_plot <- fatty_acid_prop_ppcp_meta_dist %>%
filter(taxon %in% c("Eulimnogammarus_verrucosus", "Eulimnogammarus_vittatus",
"Periphyton_NA")) %>%
mutate(taxon = ifelse(test = taxon == "Eulimnogammarus_verrucosus",
yes = "Eulimnogammarus verrucosus", no = taxon),
taxon = ifelse(test = taxon == "Eulimnogammarus_vittatus",
yes = "Eulimnogammarus vittatus", no = taxon),
taxon = ifelse(test = taxon == "Periphyton_NA",
yes = "Periphyton", no = taxon)) %>%
ggplot(aes(x = log10(ppcp_sum), y = c18_3w3 / c20_5w3)) +
geom_point(size = 3) +
facet_wrap(~ taxon) +
geom_smooth(method = "lm") +
geom_label(data = labels %>% filter(taxon != "Periphyton"), aes(label = label, x = -2.0, y = 5), size = 4) +
geom_label(data = labels %>% filter(taxon == "Periphyton"), aes(label = label, x = -2.0, y = 2.5), size = 4) +
xlab(label = "log10([Total PPCP])") +
ylab(label = expression(frac(18:3~omega~3 + 18:4~omega~3, 20:5~omega~3 + 22:5~omega~3 + 22:6~omega~3))) +
theme_bw() +
theme(text = element_text(size = 20))
ppcp_fa_plot
# This figure is Figure 7 within the body of the associated manuscript.
# (c16_4w3 + c16_3w3 + c16_2w6) / (  c20_4w3 + c20_2w6 + c20_3w6 + c22_4w6 )
ppcp_fa_plot <- fatty_acid_prop_ppcp_meta_dist %>%
filter(taxon %in% c("Eulimnogammarus_verrucosus", "Eulimnogammarus_vittatus",
"Periphyton_NA")) %>%
mutate(taxon = ifelse(test = taxon == "Eulimnogammarus_verrucosus",
yes = "Eulimnogammarus verrucosus", no = taxon),
taxon = ifelse(test = taxon == "Eulimnogammarus_vittatus",
yes = "Eulimnogammarus vittatus", no = taxon),
taxon = ifelse(test = taxon == "Periphyton_NA",
yes = "Periphyton", no = taxon)) %>%
ggplot(aes(x = log10(ppcp_sum), y = c18_3w3 / c20_5w3)) +
geom_point(size = 3) +
facet_wrap(~ taxon) +
geom_smooth(method = "lm") +
geom_label(data = labels %>% filter(taxon != "Periphyton"), aes(label = label, x = -2.0, y = 5), size = 4) +
geom_label(data = labels %>% filter(taxon == "Periphyton"), aes(label = label, x = -2.0, y = 2.5), size = 4) +
xlab(label = "log10([Total PPCP])") +
ylab(label = expression(frac(18:3~omega~3 , 20:5~omega~3 ))) +
theme_bw() +
theme(text = element_text(size = 20))
ppcp_fa_plot
# First compare essential fatty acid ratios in periphyton with total PPCP concentration
peri_ppcp_lm <- lm((c18_3w3 / c20_5w3) ~ log10(ppcp_sum),
data = filter(fatty_acid_prop_ppcp_meta_dist, Genus == "Periphyton"))
summary(peri_ppcp_lm)
# Second compare essential fatty acid ratios in invertebrates with total PPCP conentration
eulimnogammarus_verrucosus_ppcp_lm <- lm(((c18_3w3) / ( c20_5w3)) ~ log10(ppcp_sum),
data = filter(fatty_acid_prop_ppcp_meta_dist,
taxon == "Eulimnogammarus_verrucosus"))
summary(eulimnogammarus_verrucosus_ppcp_lm)
omega_three_six_plot <- fatty_acid_prop_ppcp_meta_dist %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
filter(fatty_acid %in% c("c20_5w3", "22_5w3", "c22_6w3",
"c22_4w6")) %>%
mutate(omega = ifelse(grepl(pattern = "w3", x = fatty_acid), "omega-3", "omega-6")) %>%
select(site, ppcp_sum, distance_weighted_population, taxon,
Genus, Species, omega, fa_prop) %>%
group_by(site, ppcp_sum, distance_weighted_population, taxon,
Genus, Species, omega) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
filter(Genus != "Hyalella") %>%
spread(omega, sum_fa_prop) %>%
ggplot(aes(x = log10(ppcp_sum), y = `omega-3`/`omega-6`)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~taxon) +
theme_bw()
omega_three_six_plot
omega_three_six_plot <- fatty_acid_prop_ppcp_meta_dist %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
filter(fatty_acid %in% c("c18_3w3", "c18_4w3", "c20_5w3", "22_5w3", "c22_6w3",
"c18_2w6", "c18_2w6t", "c22_4w6")) %>%
mutate(omega = ifelse(grepl(pattern = "w3", x = fatty_acid), "omega-3", "omega-6")) %>%
select(site, ppcp_sum, distance_weighted_population, taxon,
Genus, Species, omega, fa_prop) %>%
group_by(site, ppcp_sum, distance_weighted_population, taxon,
Genus, Species, omega) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
filter(Genus != "Hyalella") %>%
spread(omega, sum_fa_prop) %>%
ggplot(aes(x = log10(ppcp_sum), y = `omega-3`/`omega-6`)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~taxon) +
theme_bw()
omega_three_six_plot
omega_three_six_plot <- fatty_acid_prop_ppcp_meta_dist %>%
gather(fatty_acid, fa_prop, a_15_0:i_17_0) %>%
filter(fatty_acid %in% c("c18_3w3", "c18_4w3",
"c18_2w6", "c18_2w6t")) %>%
mutate(omega = ifelse(grepl(pattern = "w3", x = fatty_acid), "omega-3", "omega-6")) %>%
select(site, ppcp_sum, distance_weighted_population, taxon,
Genus, Species, omega, fa_prop) %>%
group_by(site, ppcp_sum, distance_weighted_population, taxon,
Genus, Species, omega) %>%
summarize(sum_fa_prop = sum(fa_prop)) %>%
ungroup() %>%
filter(Genus != "Hyalella") %>%
spread(omega, sum_fa_prop) %>%
ggplot(aes(x = log10(ppcp_sum), y = `omega-3`/`omega-6`)) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~taxon) +
theme_bw()
omega_three_six_plot
