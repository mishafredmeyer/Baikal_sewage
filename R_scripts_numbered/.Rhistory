x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10,30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
annotate("label", x = 0.2, y = 0.2,
label = paste("Stress: ", round(invert_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 10))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.key.height = unit(0.7, "in"))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon,
size = ppcp_sum),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(name = "taxon", values = viridis(30)[c(4, 9, 17, 24)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10,30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
annotate("label", x = 0.2, y = 0.2,
label = paste("Stress: ", round(invert_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 10))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.key.height = unit(0.4, "in"))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon,
size = ppcp_sum),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(name = "taxon", values = viridis(30)[c(4, 9, 17, 24)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10,30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
annotate("label", x = 0.2, y = 0.2,
label = paste("Stress: ", round(invert_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 10))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.key.height = unit(0.5, "in"))
nmds
ggsave(filename = "filamentous_diatom_nmds_amphipods.png", plot = nmds, device = "png",
path = "../figures/", width = 16, height = 10, units = "in")
ggsave(filename = "filamentous_diatom_nmds_amphipods.png", plot = nmds, device = "png",
path = "../figures/", width = 16, height = 10, units = "in")
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = 0.5,
size = ppcp_sum, fill = taxon),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(values = viridis(20)[c(4, 10)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = 1, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10, 30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
ylab("") +
ylim(c(0,1.25)) +
annotate("label", x = 0, y = 0.25,
label = paste("Stress: ", round(peri_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 15))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.key.height = unit(0.5, "in"))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = 0.5,
size = ppcp_sum, fill = taxon),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(values = viridis(20)[c(4, 10)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = 1, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10, 30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
ylab("") +
ylim(c(0,1.25)) +
annotate("label", x = 0, y = 0.25,
label = paste("Stress: ", round(peri_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 15))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.key.height = unit(1, "in"))
nmds
# Extract scores for each site and add additional data for analysis and plotting
data_scores <- as.data.frame(scores(peri_nmds)) %>%
mutate(site = periphyton_fatty_acids$site,
taxon = periphyton_fatty_acids$taxon,
taxon = gsub(pattern = "_", replacement = " ", x = taxon),
taxon = gsub(pattern = "NA", replacement = "", x = taxon),
taxon = gsub(pattern = "Drapa", replacement = "Drapa spp.", x = taxon),
ppcp_sum = periphyton_fatty_acids$ppcp_sum)
species_scores <- as.data.frame(scores(peri_nmds, display = "species"))
species_scores$species <- rownames(species_scores)
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = 0.5,
size = ppcp_sum, fill = taxon),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(values = viridis(20)[c(4, 10)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = 1, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10, 30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
ylab("") +
ylim(c(0,1.25)) +
annotate("label", x = 0, y = 0.25,
label = paste("Stress: ", round(peri_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 15))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.key.height = unit(1, "in"))
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = 0.5,
size = ppcp_sum, fill = taxon),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(values = viridis(20)[c(4, 10)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = 1, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10, 30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
ylab("") +
ylim(c(0,1.25)) +
annotate("label", x = 0, y = 0.25,
label = paste("Stress: ", round(peri_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 15))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.key.height = unit(0.4, "in"))
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = 0.5,
size = ppcp_sum, fill = taxon),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(values = viridis(20)[c(4, 10)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = 1, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10, 30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
ylab("") +
ylim(c(0,1.25)) +
annotate("label", x = 0, y = 0.25,
label = paste("Stress: ", round(peri_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 15))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.key.height = unit(0.5, "in"))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = 0.5,
size = ppcp_sum, fill = taxon),
alpha = .5, shape = 21, stroke = 5, color = "grey70") +
scale_fill_manual(values = viridis(20)[c(4, 10)]) +
geom_text_repel(data = species_scores %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = 1, label = species),
size = 10, segment.size = NA) +
scale_size_continuous(name = "[Total PPCP]", range = c(10, 30)) +
guides(shape = guide_legend(override.aes = list(size=10))) +
ggtitle("NMDS with Filamentous:Diatom Fatty Acids") +
ylab("") +
ylim(c(0,1.25)) +
annotate("label", x = 0, y = 0.25,
label = paste("Stress: ", round(peri_nmds$stress, digits = 3)),
size = 10) +
theme_minimal() +
guides(fill = guide_legend(override.aes = list(size = 15))) +
theme(legend.position = "right",
title = element_text(size = 20),
axis.text = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
legend.key.height = unit(0.75, "in"))
nmds
ggsave(filename = "filamentous_diatom_nmds_peri_drapa.png", plot = nmds, device = "png",
path = "../figures/", width = 16, height = 8, units = "in")
# Extract scores for each site and add additional data for analysis and plotting
data_scores <- as.data.frame(scores(whole_fatty_acid_metaMDS)) %>%
mutate(site = fatty_acid_whole_wide$site,
taxon = fatty_acid_whole_wide$taxon,
taxon = gsub(pattern = "_", replacement = " ", x = taxon),
taxon = gsub(pattern = "NA", replacement = "", x = taxon),
taxon = gsub(pattern = "Drapa", replacement = "Drapa spp.", x = taxon))
# Pull species scores from NMDS
species_scores <- as.data.frame(scores(x = whole_fatty_acid_metaMDS, display = "species"))
species_scores$species <- rownames(species_scores)
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon),
size = 10, alpha = .5, shape = 21, stroke = 2, color = "grey60") +
scale_fill_viridis_d(option = "plasma") +
geom_text_repel(data = species_scores %>%
filter(species %in% c("c18_3w3", "c18_1w9", "c18_2w6", "c16_0",
"c14_0", "c20_5w3", "c16_1w7")) %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon),
size = 10, alpha = .6, shape = 21, stroke = 2, color = "grey60") +
scale_fill_viridis_d(option = "plasma") +
geom_text_repel(data = species_scores %>%
filter(species %in% c("c18_3w3", "c18_1w9", "c18_2w6", "c16_0",
"c14_0", "c20_5w3", "c16_1w7")) %>%
mutate(species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon),
size = 10, alpha = .6, shape = 21, stroke = 2, color = "grey60") +
scale_fill_viridis_d(option = "plasma") +
geom_text_repel(data = species_scores %>%
filter(species %in% c("c18_3w3", "c18_1w9", "c18_2w6", "c16_0",
"c14_0", "c20_5w3", "c16_1w7")) %>%
mutate(NMDS2 = ifelse(test = species == "c14_0", yes = NMDS2+0.05,
no = NMDS2),
NMDS2 = ifelse(test = species == "c16_1w7", yes = NMDS2-0.02,
no = NMDS2),
species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon),
size = 10, alpha = .6, shape = 21, stroke = 2, color = "grey60") +
scale_fill_viridis_d(option = "plasma") +
geom_text_repel(data = species_scores %>%
filter(species %in% c("c18_3w3", "c18_1w9", "c18_2w6", "c16_0",
"c14_0", "c20_5w3", "c16_1w7")) %>%
mutate(NMDS2 = ifelse(test = species == "c14_0", yes = NMDS2+0.02,
no = NMDS2),
NMDS2 = ifelse(test = species == "c16_1w7", yes = NMDS2-0.02,
no = NMDS2),
species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon),
size = 10, alpha = .6, shape = 21, stroke = 2, color = "grey60") +
scale_fill_viridis_d(option = "plasma") +
geom_text_repel(data = species_scores %>%
filter(species %in% c("c18_3w3", "c18_1w9", "c18_2w6", "c16_0",
"c14_0", "c20_5w3", "c16_1w7")) %>%
mutate(NMDS2 = ifelse(test = species == "c14_0", yes = NMDS2+0.03,
no = NMDS2),
NMDS2 = ifelse(test = species == "c16_1w7", yes = NMDS2-0.02,
no = NMDS2),
species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
# Create plot
# This figure is associated with figure S1 in the associated manuscript
nmds <- ggplot() +
geom_point(data = data_scores, aes(x = NMDS1, y = NMDS2, fill = taxon),
size = 10, alpha = .6, shape = 21, stroke = 2, color = "grey60") +
scale_fill_viridis_d(option = "plasma") +
geom_text_repel(data = species_scores %>%
filter(species %in% c("c18_3w3", "c18_1w9", "c18_2w6", "c16_0",
"c14_0", "c20_5w3", "c16_1w7")) %>%
mutate(NMDS2 = ifelse(test = species == "c14_0", yes = NMDS2+0.04,
no = NMDS2),
NMDS2 = ifelse(test = species == "c16_1w7", yes = NMDS2-0.02,
no = NMDS2),
species = gsub(pattern = "c", replacement = "",
x = species),
species = gsub(pattern = "_", replacement = ":",
x = species),
species = gsub(pattern = "w", replacement = "\U03C9",
x = species)),
aes(x = NMDS1, y = NMDS2, label = species),
size = 10) +
ggtitle("NMDS with Entire FA Spectrum") +
annotate("label", x = 0.4, y = 0.45,
label = paste("Stress: ", round(whole_fatty_acid_metaMDS$stress, digits = 3)),
size = 10) +
theme_minimal() +
theme(legend.position = "bottom",
title = element_text(size = 20),
axis.text = element_text(size = 16),
axis.title = element_text(size = 18),
legend.text = element_text(size = 12))
nmds
ggsave(filename = "all_species_all_FA.png", plot = nmds, device = "png",
path = "../figures/", width = 12, height = 10, units = "in", dpi = 300)
ggsave(filename = "all_species_all_FA.png", plot = nmds, device = "png",
path = "../figures/", width = 16, height = 10, units = "in", dpi = 300)
ggsave(filename = "all_species_all_FA.png", plot = nmds, device = "png",
path = "../figures/", width = 14, height = 10, units = "in", dpi = 300)
